#!/bin/bash
echo "Autostart running as: $(whoami)" > /tmp/autostart-debug.log

# Create runtime directory as root with proper ownership
mkdir -p /tmp/runtime-abc
chown abc:abc /tmp/runtime-abc
chmod 700 /tmp/runtime-abc

su - abc -c '
export DISPLAY=:1
export XDG_RUNTIME_DIR=/tmp/runtime-abc
export XDG_CONFIG_HOME=/config/.config
export XDG_DATA_HOME=/config/.local/share  
export XDG_CACHE_HOME=/config/.cache

# Create remaining directories
mkdir -p "$XDG_CONFIG_HOME" "$XDG_DATA_HOME" "$XDG_CACHE_HOME"

firefox-esr --no-sandbox --disable-gpu-sandbox --disable-software-rasterizer ${FIREFOX_CLI}
'
